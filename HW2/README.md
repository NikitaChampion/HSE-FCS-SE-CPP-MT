# Домашнее задание № 4 по дисциплине «Архитектура вычислительных систем»
> **Выполнил:** Игумнов Н.К. – БПИ191

Для более подробной информации о работе смотрите [отчёт](./Отчёт.pdf).<br>
[В данной папке](https://github.com/NikitaChampion/HSE-FCS-SE-CPP-MT/tree/master/HW2/) представлено выполнение первой домашней работы по работе с потоками в C++.

***
**Для запуска программы:**
```
clang++ -std=c++17 -Xpreprocessor -fopenmp main.cpp -o main -lomp && ./main
```
***

## **Описание задачи**
Требуется вывести список всех целых чисел, содержащих от 4 до 9 значащих цифр, которые после умножения будут содержать все те же самые цифры в произвольной последовательности и в произвольном количестве.
Входные данные: целое положительное число 𝑛, больше единицы и меньше десяти, количество потоков.
Также, согласно правкам:
- Помимо 𝑛 и количества потоков вводятся целочисленные числа 𝑙 и 𝑟 – левая и правая границы чисел. Причём [𝑙, 𝑟] ⊆ [1000, 1010) – лежит в исходных границах.
- Выводится вся необходимая информация для демонстрации корректности работы: исходное число 𝑛, отрезок [𝑙, 𝑟], количество потоков, количество выводимых чисел. Список выводится построчно в формате "исходное число, результат и номер потока".

### **Интерпретация**
Пройдёмся по всем числам 𝑥 из промежутка [𝑙, 𝑟], если после умножения на входной параметр 𝑛 ∈ (1, 10) все цифры числа 𝑛𝑒𝑤_𝑥 = 𝑥 ∙ 𝑛 содержатся в 𝑥 (и наоборот), то добавим его в итоговый ответ. Выведем список всех полученных чисел в консоль / файл.

## **Решение**
Для проверки, содержатся ли все цифры нового числа 𝑛𝑒𝑤_𝑥 в 𝑥, всего было предложено пять вариантов (𝑥 – целочисленное число):
1. Приведём 𝑥 в строку методом 𝑠𝑡𝑑: : 𝑡𝑜_𝑠𝑡𝑟𝑖𝑛𝑔(), пройдёмся по всем символам 𝑦 в полученной строке и добавим их в 𝑠𝑡𝑑: : 𝑠𝑒𝑡<*char*> 𝑠 (сделаем 𝑠. 𝑖𝑛𝑠𝑒𝑟𝑡(𝑦)). Повторим эту операцию для 𝑥 ∙ 𝑛 (только выделим для данного числа другой 𝑠𝑒𝑡). Если 𝑠𝑒𝑡-ы совпадут, то условие выполняется.
2. Пройдёмся по всем цифрам 𝑦 числа 𝑥 и добавим их в 𝑠𝑡𝑑::𝑠𝑒𝑡<𝑖𝑛𝑡> 𝑠 (сделаем 𝑠. 𝑖𝑛𝑠𝑒𝑟𝑡(𝑦)). Повторим эту операцию для 𝑥 ∙ 𝑛 (только выделим для данного числа другой 𝑠𝑒𝑡). Если 𝑠𝑒𝑡-ы совпадут, то условие выполняется.
3. Выделим для каждого числа (𝑥 и 𝑥∙𝑛) отдельный массив 𝑏𝑜𝑜𝑙-ов размера 10 (изначально заполненный 𝑓𝑎𝑙𝑠𝑒), отвечающий за наличие / отсутствие конкретных цифр в числе. Пройдёмся по всем цифрам 𝑦 числа 𝑥 и обновим значение массива 𝑎, соответствующее данной цифре (сделаем 𝑎[𝑦] = 𝑡𝑟𝑢𝑒). Повторим эту операцию для 𝑥 ∙ 𝑛. Если массивы совпадут, то условие выполняется.
4. Выделим для каждого числа отдельный 𝑠𝑡𝑑: : 𝑏𝑖𝑡𝑠𝑒𝑡<10>, отвечающий за наличие / отсутствие конкретных цифр в числе. Пройдёмся по всем цифрам 𝑦 числа 𝑥 и обновим значение 𝑏𝑖𝑡𝑠𝑒𝑡-а 𝑏, соответствующее данной цифре (сделаем 𝑏[𝑦] = 𝑡𝑟𝑢𝑒). Повторим эту операцию для 𝑥 ∙ 𝑛. Если 𝑏𝑖𝑡𝑠𝑒𝑡-ы совпадут, то условие выполняется.
5. Выделим для каждого числа отдельное дополнительное целое число 𝑓_𝑥 (𝑖𝑛𝑡), отвечающее за наличие / отсутствие конкретных цифр в числе. Пройдёмся по всем цифрам 𝑦 числа 𝑥 и обновим 𝑓_𝑥. Повторим эту операцию для 𝑥 ∙ 𝑛. Если данные числа совпадут, то условие выполняется. – Это возможно, так как в худшем случае число состоит из всех цифр 0, . . , 9. Тогда значение этой функции будет равно 20 + . . . + 29 = 210 − 1 = 1023. То есть это число помещается в 𝑖𝑛𝑡.

## **Код программы**
[Исходный код](./src/main.cpp)<br>

- В данной задаче я применяю модель **итеративного параллелизма**.
- Функция 𝑹𝒆𝒂𝒅 считывает входные данные: 𝑛 – входной множитель, 𝑙 – левая граница чисел, 𝑟 – правая граница чисел, *thread_number* – количество потоков 𝑓𝑖𝑙𝑒_𝑛𝑎𝑚𝑒 – путь до выходного файла (в случае надобности).
- Функция 𝑪𝒐𝒎𝒑𝒖𝒕𝒆 находит ответ на задачу, вызывая *thread_number* потоков. Каждый из потоков будет проверять своё подмножество чисел из исходного диапазона с помощью функции 𝐹𝑢𝑛 – возвращающей структуру данных, отвечающую за наличие / отсутствие конкретных цифр в числе (см. выше).
- Функция 𝑷𝒓𝒊𝒏𝒕 выводит в консоль / выходной файл (в зависимости от FILE_OUT) список всех полученных чисел.

Для того, чтобы программа сгенерировала входные числа, требуется раскомментировать 12-ую строчку: #define GENERATE.

Для того, чтобы программа выводила всю информацию в файл, требуется раскомментировать 13-ую строчку: #define FILE_OUT.

## **Тестирование программы**
Тестирование приведено в [отчёте](./Отчёт.pdf).<br>
